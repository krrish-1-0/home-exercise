<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VANGUARD HUD</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&amp;family=VT323&amp;display=swap');
        
        body { font-family: 'Orbitron', system-ui; }
        .glass { background: rgba(18,18,18,0.92); backdrop-filter: blur(20px); border: 1px solid rgba(204,255,0,0.25); }
        .neon-lime { text-shadow: 0 0 10px #CCFF00, 0 0 25px #CCFF00; }
        .ticker { animation: marquee 40s linear infinite; }
        @keyframes marquee { 0% { transform: translateX(0); } 100% { transform: translateX(-50%); } }
        .countdown { font-size: 2.8rem; font-family: 'VT323', monospace; letter-spacing: 4px; }
        .timer-running { animation: flash 1s infinite alternate; }
        @keyframes flash { from { color: #CCFF00; } to { color: #FF8C00; } }
    </style>
</head>
<body class="bg-[#121212] text-white min-h-screen pb-28">
    <!-- HEADER -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-[#121212]/95 backdrop-blur-xl border-b border-[#CCFF00]/20">
        <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-[#CCFF00] text-black font-black text-4xl flex items-center justify-center rounded-2xl">V</div>
                <div class="leading-none">
                    <span class="text-3xl font-bold tracking-widest neon-lime">VANGUARD</span>
                    <span class="block text-xs text-[#FF8C00] tracking-[3px]">HUD ‚Ä¢ AUTO-REP MODE</span>
                </div>
            </div>
            <div class="text-right">
                <div class="text-xs text-white/50 font-mono">TOTAL VOLUME</div>
                <div id="total-volume" class="text-5xl font-black text-[#FF8C00] tabular-nums">0</div>
            </div>
        </div>
    </header>

    <div class="pt-24 max-w-6xl mx-auto px-4">
        <!-- DASHBOARD -->
        <div id="dashboard" class="screen">
            <div class="flex justify-between items-center mb-6">
                <div class="font-mono text-sm text-white/60">ACTIVE OPS ‚Ä¢ AUTO TIMER MODE</div>
                <button onclick="addNewExercise()" class="px-6 py-3 bg-[#CCFF00] text-black font-bold rounded-3xl flex items-center gap-2">
                    <i class="fa-solid fa-plus"></i> NEW OP
                </button>
            </div>

            <div id="exercises-list" class="space-y-6"></div>

            <!-- QUICK LOAD -->
            <div class="mt-12">
                <div class="text-xs font-mono text-white/60 mb-4">QUICK DEPLOY</div>
                <div class="grid grid-cols-3 gap-3">
                    <button onclick="quickAdd(0)" class="glass rounded-3xl p-6 text-center hover:border-[#CCFF00]">
                        <div class="text-5xl mb-3">üèãÔ∏è</div>
                        <div class="font-bold">DANDS</div>
                        <div class="text-xs text-white/70">Hindu Pushups</div>
                    </button>
                    <button onclick="quickAdd(1)" class="glass rounded-3xl p-6 text-center hover:border-[#CCFF00]">
                        <div class="text-5xl mb-3">‚òÄÔ∏è</div>
                        <div class="font-bold">SURYA</div>
                        <div class="text-xs text-white/70">Namaskar</div>
                    </button>
                    <button onclick="quickAdd(2)" class="glass rounded-3xl p-6 text-center hover:border-[#CCFF00]">
                        <div class="text-5xl mb-3">ü¶ç</div>
                        <div class="font-bold">PULL-UP</div>
                        <div class="text-xs text-white/70">Chin-ups</div>
                    </button>
                </div>
            </div>
        </div>

        <!-- HISTORY -->
        <div id="history-screen" class="screen hidden">
            <div class="text-xs font-mono text-white/60 mb-5">TACTICAL LOG ‚Ä¢ MISSION HISTORY</div>
            <div id="history-list" class="space-y-4"></div>
        </div>

        <!-- SETTINGS -->
        <div id="settings-screen" class="screen hidden">
            <div class="glass rounded-3xl p-8 space-y-10">
                <div>
                    <label class="block text-sm font-mono mb-3">PULSE RATE (volume calc)</label>
                    <input type="range" id="pulse-range" min="1" max="3600" value="2" class="w-full accent-[#CCFF00]">
                    <div class="flex justify-between text-xs font-mono text-white/50">
                        <span>1s</span><span id="pulse-val">2s</span><span>1hr</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-mono mb-3">BODYWEIGHT (kg)</label>
                    <input id="bw-input" type="number" value="70" class="w-full text-5xl text-center bg-black/70 border border-white/20 rounded-3xl py-6">
                </div>
                <button onclick="resetAll()" class="w-full py-6 text-red-400 border border-red-500/30 rounded-3xl font-mono text-sm">WIPE ALL DATA</button>
            </div>
        </div>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="fixed bottom-0 left-0 right-0 bg-[#121212]/95 border-t border-[#CCFF00]/30 backdrop-blur-2xl z-50">
        <div class="grid grid-cols-3 max-w-6xl mx-auto">
            <button onclick="showScreen(0)" class="py-6 text-[#CCFF00] flex flex-col items-center border-t-4 border-[#CCFF00]">
                <i class="fa-solid fa-tachometer-alt text-2xl"></i>
                <span class="text-[10px] font-mono">DASH</span>
            </button>
            <button onclick="showScreen(1)" class="py-6 text-white/70 flex flex-col items-center">
                <i class="fa-solid fa-clock-rotate-left text-2xl"></i>
                <span class="text-[10px] font-mono">LOG</span>
            </button>
            <button onclick="showScreen(2)" class="py-6 text-white/70 flex flex-col items-center">
                <i class="fa-solid fa-sliders text-2xl"></i>
                <span class="text-[10px] font-mono">SETUP</span>
            </button>
        </div>
    </nav>

    <!-- ADD MODAL -->
    <div id="add-modal" class="hidden fixed inset-0 bg-black/90 flex items-end z-[100]">
        <div class="glass w-full rounded-t-3xl p-8">
            <div class="text-xl mb-6 font-bold">DEPLOY NEW OPERATION</div>
            <input id="ex-name" placeholder="Exercise name" class="w-full bg-black/60 border border-white/30 rounded-3xl px-6 py-6 text-xl mb-6">
            
            <div class="grid grid-cols-3 gap-4">
                <div>
                    <div class="text-xs text-white/50 mb-2">LOAD (kg)</div>
                    <input id="ex-load" type="number" value="70" class="w-full text-center bg-black/60 border border-white/30 rounded-3xl py-5 text-4xl">
                </div>
                <div>
                    <div class="text-xs text-white/50 mb-2">TARGET REPS</div>
                    <input id="ex-target" type="number" value="50" class="w-full text-center bg-black/60 border border-white/30 rounded-3xl py-5 text-4xl">
                </div>
                <div>
                    <div class="text-xs text-white/50 mb-2">INTERVAL</div>
                    <div class="flex items-center gap-2 bg-black/60 border border-white/30 rounded-3xl px-4 py-5">
                        <input id="ex-interval" type="number" value="5" min="1" max="3600" class="w-20 text-center bg-transparent text-4xl outline-none">
                        <span class="text-white/60 text-lg">s</span>
                    </div>
                </div>
            </div>
            
            <div class="grid grid-cols-2 gap-4 mt-10">
                <button onclick="hideModal()" class="py-7 border border-white/40 rounded-3xl font-medium">CANCEL</button>
                <button onclick="saveNewExercise()" class="py-7 bg-[#CCFF00] text-black font-bold rounded-3xl">DEPLOY OP</button>
            </div>
        </div>
    </div>

    <!-- MANTRA TICKER -->
    <div class="fixed bottom-28 left-0 right-0 bg-black/70 py-3 overflow-hidden border-t border-b border-[#CCFF00]/10 z-40">
        <div id="ticker" class="ticker flex gap-12 text-[#CCFF00]/70 text-sm whitespace-nowrap font-light"></div>
    </div>

    <script>
        let state = {
            exercises: [],
            history: [],
            bodyWeight: 70,
            pulseRate: 2
        }

        const mantras = [
            "EVERY SECOND IS A REP ‚Ä¢ EVERY REP IS A VICTORY",
            "PUSH. REST. REPEAT. BECOME UNSTOPPABLE.",
            "‡§Ø‡§§‡•ç‡§∞ ‡§ß‡§∞‡•ç‡§Æ‡§∏‡•ç‡§§‡§§‡•ç‡§∞ ‡§ú‡§Ø‡§É ‚Äî RIGHTEOUSNESS BRINGS VICTORY",
            "NO PAIN ‚Ä¢ NO GAIN ‚Ä¢ NO EXCUSES",
            "AUTO MODE ENGAGED ‚Ä¢ LEGEND MODE ACTIVATED"
        ]

        let activeTimers = {} // exercise id ‚Üí interval ID

        function loadData() {
            const saved = localStorage.getItem('vanguardAutoHUD')
            if (saved) state = JSON.parse(saved)
            if (!state.exercises) state.exercises = []
            if (!state.history) state.history = []
        }

        function saveData() {
            localStorage.setItem('vanguardAutoHUD', JSON.stringify(state))
        }

        function calculateVolume() {
            let vol = 0
            state.exercises.forEach(ex => vol += ex.totalReps * ex.load)
            document.getElementById('total-volume').textContent = Math.round(vol).toLocaleString()
        }

        function renderExercises() {
            const container = document.getElementById('exercises-list')
            container.innerHTML = ''

            state.exercises.forEach((ex, i) => {
                const progress = Math.min(100, Math.floor((ex.totalReps / ex.targetReps) * 100))
                const timeLeft = ex.remaining !== undefined ? ex.remaining : ex.intervalSeconds
                const mmss = `${Math.floor(timeLeft/60).toString().padStart(2,'0')}:${(timeLeft%60).toString().padStart(2,'0')}`

                const card = document.createElement('div')
                card.className = `glass rounded-3xl p-7 ${ex.isRunning ? 'ring-2 ring-[#CCFF00]/50' : ''}`
                card.innerHTML = `
                    <div class="flex justify-between">
                        <div>
                            <div class="font-bold text-xl">${ex.name}</div>
                            <div class="text-xs text-white/50">${ex.load} kg ‚Ä¢ Target ${ex.targetReps}</div>
                        </div>
                        <button onclick="deleteEx(${i})" class="text-red-400 text-2xl"><i class="fa-solid fa-trash"></i></button>
                    </div>

                    <div class="flex items-end gap-4 mt-8 mb-6">
                        <div class="text-7xl font-black tabular-nums text-[#CCFF00]">${ex.totalReps}</div>
                        <div class="text-3xl text-white/30">/ ${ex.targetReps}</div>
                    </div>

                    <div class="h-2.5 bg-zinc-900 rounded-full overflow-hidden mb-8">
                        <div class="h-full bg-gradient-to-r from-[#CCFF00] to-[#FF8C00]" style="width:${progress}%"></div>
                    </div>

                    <!-- TIMER SECTION -->
                    <div class="bg-black/60 rounded-2xl p-5 flex items-center gap-6">
                        <div class="flex-1">
                            <div class="text-xs text-white/50 font-mono mb-1">INTERVAL</div>
                            <div class="flex items-center">
                                <input type="number" value="${ex.intervalSeconds}" min="1" max="3600"
                                    onchange="updateInterval(${i}, this.value)"
                                    class="bg-transparent w-16 text-4xl text-center outline-none">
                                <span class="text-white/70 ml-1">s</span>
                            </div>
                        </div>

                        <div class="text-center flex-1">
                            <div class="text-xs text-white/50 font-mono">COUNTDOWN</div>
                            <div id="timer-${ex.id}" class="countdown ${ex.isRunning ? 'timer-running' : ''}">${mmss}</div>
                        </div>

                        <div class="flex flex-col gap-3">
                            <button onclick="toggleTimer(${i})" 
                                class="px-8 py-4 rounded-2xl font-bold text-sm ${ex.isRunning ? 'bg-red-500/80' : 'bg-[#CCFF00] text-black'}">
                                ${ex.isRunning ? 'PAUSE' : 'START'}
                            </button>
                            <button onclick="manualRep(${i})" 
                                class="px-8 py-2 text-xs border border-white/30 rounded-2xl hover:bg-white/10">+1 REP</button>
                        </div>
                    </div>
                `
                container.appendChild(card)
            })
        }

        function updateInterval(index, newVal) {
            const val = Math.max(1, Math.min(3600, parseInt(newVal) || 5))
            state.exercises[index].intervalSeconds = val
            if (!state.exercises[index].remaining) state.exercises[index].remaining = val
            saveData()
            renderExercises()
        }

        function toggleTimer(index) {
            const ex = state.exercises[index]
            if (ex.isRunning) {
                // pause
                if (activeTimers[ex.id]) {
                    clearInterval(activeTimers[ex.id])
                    delete activeTimers[ex.id]
                }
                ex.isRunning = false
            } else {
                // start
                if (!ex.remaining) ex.remaining = ex.intervalSeconds
                ex.isRunning = true
                startExerciseTimer(index)
            }
            saveData()
            renderExercises()
        }

        function startExerciseTimer(index) {
            const ex = state.exercises[index]
            if (activeTimers[ex.id]) clearInterval(activeTimers[ex.id])

            activeTimers[ex.id] = setInterval(() => {
                ex.remaining--
                if (ex.remaining <= 0) {
                    // AUTO +1 REP
                    ex.totalReps++
                    ex.remaining = ex.intervalSeconds
                    calculateVolume()
                    saveData()
                    renderExercises()
                } else {
                    // just update display
                    const el = document.getElementById(`timer-${ex.id}`)
                    if (el) {
                        const mmss = `${Math.floor(ex.remaining/60).toString().padStart(2,'0')}:${(ex.remaining%60).toString().padStart(2,'0')}`
                        el.textContent = mmss
                    }
                }
            }, 1000)
        }

        function manualRep(index) {
            state.exercises[index].totalReps++
            calculateVolume()
            saveData()
            renderExercises()
        }

        function deleteEx(index) {
            if (confirm('Remove this operation?')) {
                const ex = state.exercises[index]
                if (activeTimers[ex.id]) {
                    clearInterval(activeTimers[ex.id])
                    delete activeTimers[ex.id]
                }
                state.exercises.splice(index, 1)
                saveData()
                renderExercises()
                calculateVolume()
            }
        }

        function addNewExercise() {
            document.getElementById('add-modal').classList.remove('hidden')
            document.getElementById('ex-name').focus()
        }

        function hideModal() {
            document.getElementById('add-modal').classList.add('hidden')
        }

        function saveNewExercise() {
            const name = document.getElementById('ex-name').value.trim() || 'Unnamed Op'
            const load = parseFloat(document.getElementById('ex-load').value) || 70
            const target = parseInt(document.getElementById('ex-target').value) || 50
            const interval = parseInt(document.getElementById('ex-interval').value) || 5

            state.exercises.push({
                id: Date.now(),
                name: name,
                load: load,
                targetReps: target,
                intervalSeconds: interval,
                totalReps: 0,
                remaining: interval,
                isRunning: false
            })

            saveData()
            renderExercises()
            calculateVolume()
            hideModal()
        }

        function quickAdd(n) {
            const presets = [
                {name:"Hindu Pushups", load:70, target:80, interval:4},
                {name:"Surya Namaskar", load:75, target:15, interval:8},
                {name:"Pull-ups", load:70, target:30, interval:6}
            ]
            const p = presets[n]
            state.exercises.push({
                id: Date.now(),
                name: p.name,
                load: p.load,
                targetReps: p.target,
                intervalSeconds: p.interval,
                totalReps: 0,
                remaining: p.interval,
                isRunning: false
            })
            saveData()
            renderExercises()
            calculateVolume()
        }

        function showScreen(n) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'))
            if (n===0) document.getElementById('dashboard').classList.remove('hidden')
            if (n===1) { renderHistory(); document.getElementById('history-screen').classList.remove('hidden') }
            if (n===2) document.getElementById('settings-screen').classList.remove('hidden')
        }

        function renderHistory() {
            const container = document.getElementById('history-list')
            container.innerHTML = state.history.length ? '' : '<div class="glass rounded-3xl p-12 text-center text-white/40">No missions logged yet.<br>Finish a session to log it.</div>'

            state.history.forEach(h => {
                const d = document.createElement('div')
                d.className = 'glass rounded-3xl p-6 flex justify-between'
                d.innerHTML = `
                    <div>
                        <div class="text-sm text-white/60">${h.date}</div>
                        <div class="text-3xl font-black">${h.volume} VOL</div>
                        <div class="text-xs">${h.reps} REPS ‚Ä¢ ${h.ops} OPS</div>
                    </div>
                    <div class="text-right">
                        <div class="px-5 py-1 bg-[#CCFF00]/10 text-[#CCFF00] text-xs rounded-3xl inline-block">MISSION COMPLETE</div>
                        <div class="mt-8 text-xs text-white/40">${h.time}</div>
                    </div>
                `
                container.appendChild(d)
            })
        }

        function endMission() {
            if (state.exercises.length === 0) return alert("No active ops!")
            
            const totalReps = state.exercises.reduce((a,e)=>a+e.totalReps,0)
            const totalVol = state.exercises.reduce((a,e)=>a + e.totalReps*e.load, 0)

            state.history.unshift({
                date: new Date().toLocaleDateString('en-US',{month:'short',day:'numeric'}),
                time: new Date().toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'}),
                reps: totalReps,
                volume: Math.round(totalVol),
                ops: state.exercises.length
            })
            if (state.history.length > 20) state.history.pop()

            // stop all timers
            Object.keys(activeTimers).forEach(k => {
                clearInterval(activeTimers[k])
            })
            activeTimers = {}

            // reset current session
            state.exercises = []
            saveData()
            renderExercises()
            calculateVolume()
            alert("MISSION LOGGED ‚úì\nAll timers stopped. Check Tactical Log.")
            showScreen(1)
        }

        function resetAll() {
            if (confirm("Delete ALL data forever?")) {
                localStorage.removeItem('vanguardAutoHUD')
                location.reload()
            }
        }

        function initTicker() {
            let html = ''
            for (let i = 0; i < 4; i++) {
                mantras.forEach(m => html += `<span class="px-12">${m}</span>`)
            }
            document.getElementById('ticker').innerHTML = html
        }

        function init() {
            loadData()
            renderExercises()
            calculateVolume()
            initTicker()

            // pulse demo (every 2s update volume display)
            setInterval(() => calculateVolume(), state.pulseRate * 1000)

            // default to dashboard
            showScreen(0)

            // keyboard shortcut
            document.addEventListener('keydown', e => {
                if (e.key === '+' && document.getElementById('add-modal').classList.contains('hidden')) addNewExercise()
            })
        }

        window.onload = init
    </script>
</body>
</html>